// Testing Framework Architecture
// Render with: dot -Tpng 05_testing_framework.dot -o 05_testing_framework.png

digraph TestingFramework {
    rankdir=TB;
    node [shape=box, style="rounded,filled", fontname="Arial"];
    edge [fontname="Arial", fontsize=10];
    
    // Title
    label="Testing Framework - 72 Unit Tests + 8 Evaluation Scenarios";
    labelloc="t";
    fontsize=20;
    fontname="Arial Bold";
    
    // Test Suite
    suite [label="Test Suite\n(pytest)", fillcolor=lightcoral, penwidth=2];
    
    // Unit Tests
    subgraph cluster_unit {
        label="Unit Tests (72 tests)";
        style=filled;
        fillcolor=lightcyan;
        
        test1 [label="test_models.py\n\n21 tests\n• RiskTierEnum (5)\n• AISystemProfile (4)\n• ComplianceAssessment (8)\n• Serialization (4)\n\n✅ 21/21 PASSING", fillcolor=lightgreen];
        
        test2 [label="test_tools.py\n\n18 tests\n• ComplianceScoringTool (10)\n• EUAIActReferenceTool (8)\n\n✅ Tests tool logic", fillcolor=lightgreen];
        
        test3 [label="test_vector_index.py\n\n20 tests\n• Index loading (5)\n• Search operations (8)\n• Hybrid search (7)\n\n✅ Tests search", fillcolor=lightgreen];
        
        test4 [label="test_evaluation.py\n\n13 tests\n• Scenario validation (5)\n• Evaluation logic (8)\n\n✅ Tests evaluation", fillcolor=lightgreen];
    }
    
    // Evaluation Scenarios
    subgraph cluster_eval {
        label="Evaluation Scenarios (8 scenarios)";
        style=filled;
        fillcolor=lightyellow;
        
        scenario1 [label="s1: Social Scoring\nExpected: PROHIBITED\n✅ PASSING", fillcolor=lightgreen];
        scenario2 [label="s2: Real-time Biometrics\nExpected: PROHIBITED\n✅ PASSING", fillcolor=lightgreen];
        scenario3 [label="s3: Predictive Policing\nExpected: HIGH_RISK\n✅ PASSING", fillcolor=lightgreen];
        scenario4 [label="s4: Chatbot\nExpected: LIMITED_RISK\n✅ PASSING", fillcolor=lightgreen];
        scenario5 [label="s5: Auto Loan\nExpected: HIGH_RISK\n✅ PASSING", fillcolor=lightgreen];
        
        scenario6 [label="s6: Deepfake Detection\nExpected: LIMITED_RISK\n❌ FAILING (70 pts)", fillcolor=red, fontcolor=white];
        scenario7 [label="s7: Music Recommendation\nExpected: MINIMAL_RISK\n❌ FAILING (30 pts)", fillcolor=red, fontcolor=white];
        scenario8 [label="s8: Spam Filter\nExpected: MINIMAL_RISK\n❌ FAILING (30 pts)", fillcolor=red, fontcolor=white];
    }
    
    // Results
    subgraph cluster_results {
        label="Test Results & Artifacts";
        style=filled;
        fillcolor=lavender;
        
        json_docs [label="Documentation JSONs\n\n• test_models_documentation.json\n• test_tools_documentation.json\n• test_vector_index_documentation.json\n• test_evaluation_documentation.json\n• test_suite_index.json", fillcolor=wheat];
        
        json_results [label="Execution Results\n\n• test_results_latest.json\n  (pytest-json-report)\n• Timestamp\n• Duration\n• Pass/Fail status\n• Error details", fillcolor=wheat];
        
        summary [label="Evaluation Summary\n\nOverall: 5/8 (62.5%)\n• PROHIBITED: 2/2 ✅\n• HIGH_RISK: 2/2 ✅\n• LIMITED_RISK: 1/2 ⚠️\n• MINIMAL_RISK: 0/2 ❌", fillcolor=orange];
    }
    
    // Coverage Report
    coverage [label="Code Coverage\n\n• Models: 100%\n• Tools: 85%\n• Vector Index: 90%\n• Evaluation: 95%", fillcolor=skyblue];
    
    // Flow
    suite -> test1;
    suite -> test2;
    suite -> test3;
    suite -> test4;
    
    suite -> scenario1;
    suite -> scenario2;
    suite -> scenario3;
    suite -> scenario4;
    suite -> scenario5;
    suite -> scenario6;
    suite -> scenario7;
    suite -> scenario8;
    
    test1 -> json_docs;
    test2 -> json_docs;
    test3 -> json_docs;
    test4 -> json_docs;
    
    test1 -> json_results;
    test2 -> json_results;
    test3 -> json_results;
    test4 -> json_results;
    
    scenario1 -> summary;
    scenario2 -> summary;
    scenario3 -> summary;
    scenario4 -> summary;
    scenario5 -> summary;
    scenario6 -> summary;
    scenario7 -> summary;
    scenario8 -> summary;
    
    json_docs -> coverage;
    json_results -> coverage;
    summary -> coverage;
    
    // Notes
    note1 [label="Total: 72 unit tests\n21 verified passing\nFull pytest integration", shape=note, fillcolor=lightcyan];
    note2 [label="8 real-world scenarios\n5 passing (62.5%)\n100% accuracy on high-stakes", shape=note, fillcolor=lightyellow];
    note3 [label="Dual JSON system:\n• Static documentation\n• Dynamic results", shape=note, fillcolor=lavender];
    
    {rank=same; test1; note1;}
    {rank=same; scenario1; note2;}
    {rank=same; json_docs; note3;}
}
